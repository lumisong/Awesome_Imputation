# Title: 多变量时间序列插补的深度学习：综述

## 摘要

多变量时间序列数据中无处不在的缺失值破坏了时间序列的完整性，阻碍了有效的时间序列数据分析。最近，深度学习插补方法在提高损坏时间序列数据的质量方面取得了显著成功，从而提高了下游任务的性能。在本文中，我们对最近提出的深度学习插补方法进行了全面的调查。首先，我们为审查的方法提出了一个分类法，然后通过强调这些方法的优点和局限性来提供这些方法的结构化审查。我们还进行了实证实验，以研究不同方法并比较它们对下游任务的增强效果。最后，指出了未来在多变量时间序列插补研究中的开放性问题。
此项工作的所有代码和配置，包括定期维护的多变量时间序列插补论文列表，均可在[GitHub仓库](https://github.com/WenjieDu/AwesomeImputation) 中找到。

## 介绍

引言: 在金融、医学和交通等多个领域内，多变量时间序列数据的收集过程常常面临着诸多困难和不确定性，例如传感器故障、系统环境不稳定以及隐私问题等，这些都导致了数据的缺失。强调了解决缺失值问题的重要性，以确保时间序列数据的完整性和有效性，从而进行有效的数据分析。

此外，引言部分讨论了数据缺失的三种主要机制：完全随机缺失（MCAR）、随机缺失（MAR）和非随机缺失（MNAR）。每种机制都根据其对数据分析的含义以及它所需的假设进行了解释。引言强调了理解这些机制对于选择适当的插补方法至关重要。

文中介绍了插补方法的分类，根据它们处理插补不确定性的方式和它们的神经网络架构将其分类。这一分类为深入综述多变量时间序列数据的深度学习插补方法奠定了基础，突出了本文的目标是提供对这些方法的优势和局限性的结构化见解。

## 多种深度学习插补方法的分类、特点以及面向多变量时间序列插补任务的不同神经网络架构

介绍了多种深度学习插补方法的分类、特点以及面向多变量时间序列插补任务的不同神经网络架构。这部分涵盖了预测型和生成型两大类插补方法，每一种方法根据其对插补不确定性的处理能力和使用的神经网络架构进行了划分。同时，根据数据缺失的机制（如MCAR、MAR等），对这些方法进行了进一步的分类和讨论。

### 预测型插补方法

预测型插补方法主要侧重于利用现有数据来预测缺失值，这类方法通常基于RNN、CNN等神经网络架构。例如，GRU-D、M-RNN、BRITS和TimesNet等方法都属于这一类，它们主要针对完全随机缺失（MCAR）的情况，通过学习时间序列数据的动态特征来预测缺失值。

预测方法提供点估计point estimates，但不捕获插补不确定性imputation uncertainty。审查的模型包括 RNN、CNN、GNN 和基于注意力的架构。

### 生成型插补方法

生成型插补方法则着眼于生成能够反映数据潜在分布的缺失值，这类方法往往采用VAE、GAN或者扩散模型等更为复杂的生成网络架构。如GP-VAE、V-RIN和E^2GAN等，这些方法不仅适用于MCAR和MAR情况，还能够处理一定程度的非随机缺失（MNAR）。它们通过生成模型捕捉数据的分布特性，从而产生与真实数据分布相一致的插补值。

生成方法可以通过生成多个不同的插补来对插补不确定性进行建模。审查的模型包括 VAE、GAN 和基于扩散的架构。

### 模型的优缺点分析

文中还对这些生成型插补模型的优势和局限性进行了详细的分析。VAE基于的模型能够明确地建模概率，并为理解数据分布提供理论基础，但它们在捕捉复杂数据变异性方面受到生成能力的限制。GAN基于的模型在数据生成方面表现出色，能够提供高质量的插补值，但训练过程中容易遇到梯度消失等问题，影响模型的稳定性和收敛性。扩散基模型作为强大的生成工具，在捕获复杂数据模式方面具有较强能力，但其计算复杂性较高，且在处理缺失和观测部分之间的边界一致性问题上存在困难。

实验比较了现实世界数据集上的各种方法。基于注意力的模型通常表现良好，但没有一种方法可以在所有场景中占主导地位。

### 时间序列插补工具包

文中介绍了一些现有的时间序列插补任务的库，这些库提供了简单处理方式、统计方法、机器学习插补算法和深度学习插补神经网络，方便用户使用。例如，imputeTS库提供了多种简单方法（如均值、最后观测值向前填充等）和常用的插补算法（如线性插值、卡尔曼平滑等），但仅适用于单变量时间序列。而mice库则实现了链式方程多变量插补方法，用以处理多变量时间序列中的缺失值问题。

## 时间序列插补任务中现有的库和工具

讨论了时间序列插补任务中现有的库和工具，以及进行实验评估和讨论以分析不同类别的深度多变量时间序列插补方法的效果。

### 时间序列插补库和工具

- Impyute 和 Autoimpute 提供了用于横截面数据和时间序列数据的简单插补方法。其中，Impyute 提供了如移动平均窗口等简单方法，而 Autoimpute 则整合了如多项式插值和样条插值等参数方法。
- GluonTS 是一个面向时间序列的生成式机器学习包，提供了一些简单的方法，如虚拟值插补和偶然均值插补，来处理缺失值。
- Sktime 实现了一个选项，允许用户利用集成的机器学习插补算法来拟合和预测给定数据中的缺失值，尽管这种方式是单变量的。
- 当涉及到深度学习插补时，PyPOTS 是一个专注于端到端建模部分观测时间序列的工具箱。它包含了十几种深度学习神经网络，用于不完整时间序列上的任务，目前包括八种插补模型。

## 实验评估与讨论

- 进行了实证实验，以评估和分析不同类别的深度多变量时间序列插补方法。结果是在配备 AMD EPYC 7543 32核心 CPU 和 NVIDIA GeForce RTX 4090 GPU 的机器上获得的。所有代码，包括数据预处理脚本、模型配置和训练脚本，都在[GitHub 仓库](https://github.com/WenjieDu/AwesomeImputation) 中公开可用。
- 具体来说，测试了三种简单插补方法和八种深度学习神经网络在三个真实世界数据集（Air [Zhang et al., 2017]）上的表现。

## 研究方向

确定的未来主要研究方向包括处理复杂的缺失模式、优化下游性能、提高可扩展性。
